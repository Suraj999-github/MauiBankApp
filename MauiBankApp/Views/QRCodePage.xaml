<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:zxing="clr-namespace:ZXing.Net.Maui.Controls;assembly=ZXing.Net.Maui.Controls"
    x:Class="MauiBankApp.Views.QRCodePage"
    Title="QR Code Scanner">

    <Grid>

        <!-- CAMERA SCANNER -->
        <zxing:CameraBarcodeReaderView 
            x:Name="CameraView"
            BarcodesDetected="OnBarcodesDetected"
            IsDetecting="True"
            HorizontalOptions="Fill"
            VerticalOptions="Fill" />
        
       
        <!-- CLOSE BUTTON -->
        <Button
            Text="âœ•"
            FontSize="24"
            BackgroundColor="#80000000"
            TextColor="White"
            CornerRadius="30"
            WidthRequest="60"
            HeightRequest="60"
            Margin="20"
            HorizontalOptions="Start"
            VerticalOptions="Start"
            Clicked="GoBackButton_Clicked" />

        <!-- MODAL -->
        <Grid
            x:Name="ModalOverlay"
            IsVisible="False"
            BackgroundColor="#CC000000">

            <Frame
                BackgroundColor="White"
                CornerRadius="15"
                Padding="0"
                MaximumWidthRequest="350"
                HorizontalOptions="Center"
                VerticalOptions="Center">

                <VerticalStackLayout>

                    <!-- SUCCESS -->
                    <Grid x:Name="SuccessHeader" BackgroundColor="#4CAF50" Padding="20" IsVisible="False">
                        <Label Text="QR Code Scanned Successfully"
                               TextColor="White"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"/>
                    </Grid>

                    <!-- ERROR -->
                    <Grid x:Name="ErrorHeader" BackgroundColor="#F44336" Padding="20" IsVisible="False">
                        <Label Text="Scan Error"
                               TextColor="White"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"/>
                    </Grid>

                    <VerticalStackLayout Padding="20" Spacing="10">

                        <Label x:Name="InfoLabel" FontAttributes="Bold" IsVisible="False"/>

                        <Frame BackgroundColor="#F5F5F5" Padding="15">
                            <Label x:Name="ResultLabel"/>
                        </Frame>

                        <HorizontalStackLayout x:Name="FormatLayout" IsVisible="False">
                            <Label Text="Format:" FontAttributes="Bold"/>
                            <Label x:Name="FormatLabel"/>
                        </HorizontalStackLayout>

                        <Button
                            x:Name="CopyButton"
                            Text="ðŸ“‹ Copy"
                            IsVisible="False"
                            Clicked="OnCopyClicked"/>

                        <Button Text="Close" Clicked="OnCloseModalClicked"/>

                    </VerticalStackLayout>
                </VerticalStackLayout>
            </Frame>
        </Grid>
    </Grid>
</ContentPage>
